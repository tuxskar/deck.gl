<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>pydeck</title>
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v1.13.0/mapbox-gl.js"></script>
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>
    <script src='https://cdn.jsdelivr.net/npm/@deck.gl/jupyter-widget@~8.8.*/dist/index.js'></script>
    <script src="https://unpkg.com/@deck.gl/carto@^8.7.0/dist.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        #deck-map-container {
            width: 100%;
            height: 100%;
            background-color: black;
        }

        #map {
            pointer-events: none;
            height: 100%;
            width: 100%;
            position: absolute;
            z-index: 1;
        }

        #deckgl-overlay {
            z-index: 2;
            background: none;
        }

        #deck-map-wrapper {
            width: 100%;
            height: 100%;
        }

        #deck-container {
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
<div id="deck-container">
</div>
</body>
<script>
    deck.JSONConfiguration = new deck.JSONConfiguration({
        functions: {
            colorBins: deck.carto.colorBins,
            colorCategories: deck.carto.colorCategories,
            colorContinuous: deck.carto.colorContinuous
        }
    });
    const jsonInput = {
        "initialViewState": {"latitude": 0, "longitude": 0, "zoom": 1},
        "layers": [{
            "@@type": "CartoLayer",
            "connection": "carto_dw",
            "credentials": {
                "accessToken": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImRVNGNZTHAwaThjYnVMNkd0LTE0diJ9.eyJodHRwOi8vYXBwLmNhcnRvLmNvbS9hY2NvdW50X2lkIjoiYWNfaGJucmVnYWYiLCJodHRwOi8vYXBwLmNhcnRvLmNvbS9hY3RpbmdfYXMiOiJnb29nbGUtb2F1dGgyfDExMDY3OTcxOTA1OTg5NzY1OTY3OCIsImlzcyI6Imh0dHBzOi8vYXV0aC5jYXJ0by5jb20vIiwic3ViIjoiYzNHY3JScVp0TkNZTnNQMkozSHhQNUpkRnB3amVhS25AY2xpZW50cyIsImF1ZCI6ImNhcnRvLWNsb3VkLW5hdGl2ZS1hcGkiLCJpYXQiOjE2NjI0Njg1OTAsImV4cCI6MTY2MjU1NDk5MCwiYXpwIjoiYzNHY3JScVp0TkNZTnNQMkozSHhQNUpkRnB3amVhS24iLCJzY29wZSI6InJlYWQ6dG9rZW5zIHdyaXRlOnRva2VucyByZWFkOmltcG9ydHMgd3JpdGU6aW1wb3J0cyByZWFkOmNvbm5lY3Rpb25zIHdyaXRlOmNvbm5lY3Rpb25zIiwiZ3R5IjoiY2xpZW50LWNyZWRlbnRpYWxzIiwicGVybWlzc2lvbnMiOlsicmVhZDp0b2tlbnMiLCJ3cml0ZTp0b2tlbnMiLCJyZWFkOmltcG9ydHMiLCJ3cml0ZTppbXBvcnRzIiwicmVhZDpjb25uZWN0aW9ucyIsIndyaXRlOmNvbm5lY3Rpb25zIl19.aj7eSlLny0B_Uf1GMPvh2WxqQK_o4nslwangKP-LWWqS9bs98Bm0kW28vcNb1pn2zgeuCVGUIC02dpud8w9UtyDZgEsX89fTbRqov8i-G3ujIlGsOyDTJDeinwH-OCafzkOXEq66ORku3n1Wezjy4FskIXyE_xXAQM78C5C-5UjnbqP17c-Pdu0FrqP9qjvpdijQyh__URgiEydhvOs8c6q2YdWS9TcWyAq_GmR10qodIpEqk8uCBrWNzLl2LVd27qBduqCOJeR8RZuo9_75LnHrKr7TU1dn47GHQfwfJvIR7vG_oyvTX0n-mLILIp32h0D-KQyyfKJzQHNyUJg-3Q",
                "apiBaseUrl": "https://gcp-europe-west1.api.carto.com",
                "apiVersion": "v3"
            },
            "data": "carto-demo-data.demo_tables.airports",
            "getFillColor": {
                "@@function": "colorBins",
                "attr": "pct_higher_ed",
                "colors": "PinkYl",
                "domain": [0, 20, 30, 40, 50, 60, 70]
            },
            "id": "b4b2ffbb-7af0-4c01-be56-0d5d60793299",
            "pointRadiusMinPixels": 2,
            "type": "table"
        }],
        "mapProvider": "carto",
        "mapStyle": "https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",
        "views": [{"@@type": "MapView", "controller": true}],
        // "configuration": new deck.JSONConfiguration({functions: {colorBins: deck.carto.colorBins}})
    };
    const tooltip = true;
    const customLibraries = [{
        'libraryName': 'CartoLayerLibrary',
        'resourceUri': 'https://cdn.jsdelivr.net/combine/npm/h3-js@~3.7.*/dist/h3-js.umd.js,npm/@deck.gl/extensions@~8.8.*/dist.min.js,npm/@deck.gl/carto@~8.8.*/dist.min.js'
    }];

    const deckInstance = createDeck({
        container: document.getElementById('deck-container'),
        jsonInput,
        tooltip,
        customLibraries
    });

</script>
</html>
